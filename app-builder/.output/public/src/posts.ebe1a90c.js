import{U as S,N as r,r as h,h as p,u as v}from"./entry.37c85000.js";import{e as i,a as U,h as C,l as D,b as d,c as l}from"./listFilters.9b39895c.js";const u=()=>C,G=S("useProductsStore",{state:()=>({product:{},products:[],nbElements:0,extraFields:[],loading:!1}),actions:{async useAddProducts({$data:t,onError:e,onSuccess:a}){this.loading=!0;try{const s=await fetch(r().$config.API+r().$config.WS_PRODUCTS_ADD,{method:"POST",headers:u(),body:JSON.stringify(t)}),o=await s.json();return this.loading=!1,s.status==201||s.status==200?a(o):e(o)}catch(s){return this.loading=!1,e(s)}},async useGetProducts({$id:t,onError:e,onSuccess:a}){this.product={},this.loading=!0;try{const s=await fetch(r().$config.API+r().$config.WS_PRODUCTS_GET+"/"+t,{method:"GET",headers:u()}),o=await s.json();return this.loading=!1,s.status==200?(this.product=o,a(o)):e(i)}catch(s){return this.loading=!1,e(s)}},async useProductsList({onError:t,onSuccess:e}){this.loading=!0;try{const a=await fetch(r().$config.API+r().$config.WS_PRODUCTS_LIST,{method:"GET",headers:u()}),s=await a.json();return this.loading=!1,a.status==200?(this.products=s.products.slice(0,10),e(s)):t(i)}catch(a){return this.loading=!1,t(a)}},async useProductsItemsNumber({$filters:t,onError:e,onSuccess:a}){this.loading=!0;try{r;const s=await fetch(r().$config.API+r().$config.WS_PRODUCTS_LIST,{method:"GET",headers:{...u(),...t}}),o=await s.json();return this.loading=!1,s.status==200?(this.nbElements=o.length(),a(o)):e(i)}catch(s){return this.loading=!1,e(s)}},async useUpdateProducts({$data:t,onError:e,onSuccess:a}){this.loading=!0;try{const s=await fetch(r().$config.API+r().$config.WS_PRODUCTS_UPDATE+"/"+t.id,{method:"PUT",headers:u(),body:JSON.stringify(t)}),o=await s.json();return this.loading=!1,s.status==200?a(o):e(o)}catch(s){return this.loading=!1,e(s)}},async useDeleteProducts({$id:t,onError:e,onSuccess:a}){this.loading=!0;try{const s=await fetch(r().$config.API+r().$config.WS_PRODUCTS_DELETE+"/"+t,{method:"DELETE",headers:u()});return this.loading=!1,s.status==200?a():e("error")}catch(s){return this.loading=!1,e(s)}},async useGetExtraFieldsProducts(){this.loading=!0;const t={};await U({headers:u(),body:t,onError:()=>{this.loading=!1},onSuccess:e=>{this.loading=!1,e[0]&&(this.extraFields=e[0].extraField)}})}}}),L=S("useLanguageStore",{state:()=>({languages:[],language:{}}),actions:{async useLanguageList({onError:t=()=>{},onSuccess:e=()=>{}}){try{const s=await(await fetch("/mock/lang.json",{headers:{"Content-type":"application/json"}})).json();return s?(this.languages=s,e(s)):t("Server error")}catch(a){return t(a)}}}}),b=()=>{const t=L(),e=h(!1),a=async()=>{e.value=!0,t.useLanguageList({onError:()=>{e.value=!1},onSuccess:()=>{e.value=!1}})},s=p(()=>t.languages);return{useGetData:a,langs:s,loading:e}},x=()=>{const t=G(),e=h({}),a=r().$i18n.locale.value,{bodyFilter:s}=D(),o=h(null),E=v({}),y=(n,c)=>{c?e.value[c]=n:e.value={...e.value,...n}},$=p(()=>t.loading),m=n=>{o.value.clearValidate(n)},T=n=>{t.useDeleteProducts({$id:n.id,onError:d,onSuccess:()=>{l(r().$i18n.t("SUCCESS")),g()}})},g=()=>{P(),f()},f=()=>{t.useProductsItemsNumber({$filters:s.value,onError:()=>{},onSuccess:()=>{}})},P=()=>{t.useProductsList({$filters:s.value,onError:()=>{},onSuccess:()=>{}})};return{productsForm:o,bodyFilter:s,productsPlayload:e,loadingProducts:$,rules:E,useRemoveProducts:T,useGetProductsList:g,useAddProducts:()=>{o.value.validate().then(n=>{if(n)t.useAddProducts({$data:e.value,onError:c=>d(c.code=="5003"?r().$i18n.t("PRODUCTS.EXIST"):""),onSuccess:()=>l(r().$i18n.t("SUCCESS"),{path:"/"+a+"/products"})});else return!1})},useUpdateProducts:()=>{o.value.validate().then(n=>{if(n)t.useUpdateProducts({$data:e.value,onError:c=>d(c.code=="5003"?r().$i18n.t("PRODUCTS.EXIST"):""),onSuccess:()=>l(r().$i18n.t("SUCCESS"),{path:"/"+a+"/products"})});else return!1})},useGetProducts:n=>{e.value.id=n,t.useGetProducts({$id:n,onError:()=>{},onSuccess:()=>{}})},useFormDataChange:y,useClearValidate:m,useGetProductsListItems:P,useGetProductsTotalItems:f,useGetExtraFieldsProducts:()=>{t.useGetExtraFieldsProducts()}}};export{b as a,x as b,G as u};
