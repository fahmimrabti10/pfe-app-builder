import{f as O}from"./formEvents.1ab2da43.js";import{d as w,r as p,N as r,j as E,k as M,o as f,c,a as v,F as j,t as S,H as z,P as q,y as d,A as F,b as h,w as y,e as P,_ as T}from"./entry.37c85000.js";import{j as A,b as H,i as K}from"./listFilters.9b39895c.js";import{_ as R,a as W}from"./langue.efbb750b.js";import{_ as G,a as J}from"./FormBuilder.e1ce4cde.js";import{B as Q}from"./button.62af8ef2.js";import"./useConfigInject.58732bf7.js";import"./index.54946f0a.js";import"./Search.887af709.js";import"./index.cb11142e.js";import"./RightOutlined.1465a480.js";import"./collapseMotion.d40d7f6b.js";import"./index.6a5f261a.js";import"./FormItem.dc592ecb.js";import"./Col.d66ce3c0.js";import"./responsiveObserve.d14d9088.js";import"./styleChecker.d57dbbf0.js";import"./debounce.ba6c6e44.js";import"./index.ff1f244c.js";import"./Form.55c6e749.js";import"./BackButton.006f1c40.js";import"./index.2c750beb.js";import"./index.2793a51d.js";const X={languagesData:{type:Array,default:()=>[],required:!0},listOfValues:{type:Array,default:()=>[]},rule:{type:Array,default:()=>[]},name:{type:String,required:!0},label:{type:String,default:()=>"",required:!0},disabled:{type:Boolean,default:()=>!1},readOnly:{type:Boolean,default:()=>!1},relatedKey:{type:String,default:()=>null},acceptOnly:{type:String,default:()=>"*"},pathAssetManager:{type:String,default:()=>""},hideLangsIcon:{type:Boolean,default:()=>!1},showLangs:{type:Boolean,default:()=>!1},errorMessage:{type:String,default:()=>""},errorDisabledMsg:{type:String,default:()=>""},headers:{type:Object,required:!1,default:()=>({})}},Y={class:"input-wrapper-upload-lang"},Z={class:"label-item antformLabel"},x=["title"],ee=["title"],ae={class:"landscape-items input-localized-mark"},te=w({__name:"LocaleUploadfield",props:X,emits:O(null).events,setup(V,{emit:$}){const s=V,m=p(s.showLangs||s.hideLangsIcon),U=r().$i18n.locale.value,o=p([]),{useClearValidate:le,useFormDataChange:_}=O($),u=p(!0),i=p([]),b={authorization:decodeURIComponent(r().$auth.token)};E(()=>{L(),C(o.value)}),M(s,(e,a)=>{o.value=[],a&&(L(),C(o.value))});const L=()=>{let e=[];s.languagesData.forEach((a,t)=>{if(i.value.push({fileList:[]}),e.push({isoCode:a.isoCode,value:""}),s.listOfValues&&s.listOfValues.length>0){let l=s.listOfValues.find(n=>n.isoCode===a.isoCode);l&&(e[t]={isoCode:l.isoCode,value:l.value})}}),o.value=e,_(e,s.name)},k=e=>{let a=Object.assign([],e);const t=a.findIndex(l=>l.isoCode==U);return t>0&&a.splice(1,0,...a.splice(0,t)),a},B=(e,a,t)=>{if(a!="*"&&a!=""){let l=e.name.match(/\.[0-9a-z]+$/i)[0],n=a.replace(/\s/g,"").split(",");return u.value=!1,n.indexOf(l.toLowerCase())>-1?u.value=!0:H(r().$i18n.t(t)),u.value}else u.value=!0},I=(e,a,t)=>{if(u.value&&(i.value[a].fileList=e.fileList,i.value[a].fileList=i.value[a].fileList.slice(-1)),e.file.status==="done"){let l=i.value[a].fileList[0].name.match(/\.[0-9a-z]+$/i)[0];i.value[a].fileList[0].thumbUrl=A(l,i.value[a].fileList[0].thumbUrl),o.value[t].value=e.file.response.url,o.value[t].type=e.file.type}else e.file.status==="error"?K(r().$i18n.t("uploadError"),"error"):(o.value[t].value="",o.value[t].type="");_(o.value,s.name)},D=()=>{s.disabled&&s.errorDisabledMsg},C=e=>{s.listOfValues&&s.listOfValues.length>0&&k(e).forEach((t,l)=>{if(t.value){i.value[l].fileList=[{uid:l,name:t.value.match(/[^/]*$/)[0],status:"done",thumbUrl:t.value}];let n=i.value[l].fileList[0].name.match(/\.[0-9a-z]+$/i)[0];i.value[l].fileList[0].thumbUrl=A(n,t.value)}})};return(e,a)=>{const t=G,l=Q,n=J;return f(),c("div",Y,[v("div",Z,[v("div",{class:j(e.rule&&e.rule.length>0?"ant-form-item-required":"")},S(e.label),3),!e.showLangs||!e.hideLangsIcon?z((f(),c("div",{key:0,class:"lang-btn font-sf-bold",onClick:a[0]||(a[0]=()=>m.value=!d(m))},[d(m)?(f(),c("img",{key:0,src:R,class:"gloab-btn-icon",type:"global",alt:"Icon lang",title:e.$t("languageSelect")},null,8,x)):(f(),c("img",{key:1,src:W,class:"gloab-btn-icon closed-icon",type:"global",alt:"Icon lang",title:e.$t("languageSelect")},null,8,ee))],512)),[[q,e.languagesData.length>1]]):F("",!0)]),v("div",ae,[h(n,{accept:e.acceptOnly,"list-type":"picture",action:("useNuxtApp"in e?e.useNuxtApp:d(r))().$config.API+("useNuxtApp"in e?e.useNuxtApp:d(r))().$config.WS_ADD_MEDIA+e.$i18n.locale+e.pathAssetManager,headers:Object.keys(b).length==0?e.header:b,"read-only":e.readOnly,disabled:e.disabled,"before-upload":g=>B(g,e.acceptOnly,e.errorMessage),onChange:a[1]||(a[1]=g=>I(g,e.index,d(o).findIndex(N=>N.isoCode==e.language.isoCode)))},{default:y(()=>[h(l,{onClick:D},{icon:y(()=>[h(t)]),default:y(()=>[P(" "+S(e.$t("upload")),1)]),_:1})]),_:1},8,["accept","action","headers","read-only","disabled","before-upload"])])])}}});const $e=T(te,[["__scopeId","data-v-36a3d566"]]);export{$e as default};
